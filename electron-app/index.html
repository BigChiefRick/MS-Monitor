<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Endpoint Monitor</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <header class="header">
        <div class="logo">
            <h1>🌐 Microsoft Endpoint Monitor</h1>
        </div>
        <div class="header-controls">
            <div class="connection-status">
                <div id="statusIndicator" class="status-indicator"></div>
                <span id="connectionStatus">Connecting...</span>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">
                <span id="themeIcon">🌙</span>
                <span id="themeText">Dark Mode</span>
            </button>
        </div>
    </header>

    <div class="container">
        <div class="dashboard-grid">
            <div class="stat-card">
                <div id="totalConnections" class="stat-value">0</div>
                <div class="stat-label">Total Connections</div>
            </div>
            <div class="stat-card">
                <div id="microsoftConnections" class="stat-value">0</div>
                <div class="stat-label">Microsoft Connections</div>
            </div>
            <div class="stat-card">
                <div id="activeServices" class="stat-value">0</div>
                <div class="stat-label">Active Services</div>
            </div>
            <div class="stat-card">
                <div id="averageLatency" class="stat-value">0</div>
                <div class="stat-label">Avg Latency (ms)</div>
            </div>
        </div>

        <div class="content-grid">
            <div class="panel">
                <div class="panel-title">
                    Recent Microsoft Connections
                    <button id="refreshBtn" class="refresh-btn">🔄 Refresh</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Process</th>
                            <th>Endpoint</th>
                            <th>Latency</th>
                            <th>Status</th>
                            <th>Time</th>
                        </tr>
                    </thead>
                    <tbody id="connectionsTableBody">
                        <tr>
                            <td><span class="service-badge teams">Microsoft Teams</span></td>
                            <td class="process-name">Teams.exe</td>
                            <td class="endpoint-address">teams.microsoft.com:443</td>
                            <td><span class="latency good">45ms</span></td>
                            <td><span class="status-badge status-established">Established</span></td>
                            <td class="timestamp">12:34:56</td>
                        </tr>
                        <tr>
                            <td><span class="service-badge outlook">Outlook</span></td>
                            <td class="process-name">outlook.exe</td>
                            <td class="endpoint-address">outlook.office365.com:443</td>
                            <td><span class="latency good">32ms</span></td>
                            <td><span class="status-badge status-established">Established</span></td>
                            <td class="timestamp">12:34:45</td>
                        </tr>
                        <tr>
                            <td><span class="service-badge onedrive">OneDrive</span></td>
                            <td class="process-name">OneDrive.exe</td>
                            <td class="endpoint-address">onedrive.live.com:443</td>
                            <td><span class="latency fair">67ms</span></td>
                            <td><span class="status-badge status-established">Established</span></td>
                            <td class="timestamp">12:34:30</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="panel">
                <div class="panel-title">Active Services</div>
                <table>
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Connections</th>
                            <th>Avg Latency</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="servicesTableBody">
                        <tr>
                            <td><span class="service-badge teams">Microsoft Teams</span></td>
                            <td class="connection-count">3</td>
                            <td><span class="latency good">45ms</span></td>
                            <td><span class="status-badge status-active">Active</span></td>
                        </tr>
                        <tr>
                            <td><span class="service-badge outlook">Outlook</span></td>
                            <td class="connection-count">2</td>
                            <td><span class="latency good">32ms</span></td>
                            <td><span class="status-badge status-active">Active</span></td>
                        </tr>
                        <tr>
                            <td><span class="service-badge onedrive">OneDrive</span></td>
                            <td class="connection-count">1</td>
                            <td><span class="latency fair">67ms</span></td>
                            <td><span class="status-badge status-active">Active</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>Microsoft Endpoint Monitor v1.0.0 - Real-time endpoint monitoring by BigChiefRick</p>
    </footer>

    <script src="renderer.js"></script>
</body>
</html>
